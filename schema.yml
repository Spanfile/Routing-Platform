---
templates:
- name: string
  regex: '.*'
- name: hostname
  regex: '[a-zA-Z0-9][a-zA-Z0-9\-]{0,63}'
- name: ipv4-cidr
  regex: '((?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))/([0-9]|[12][0-9]|3[0-2])'
- name: ipv4
  regex: '(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)'
- name: fqdn
  regex: '(?:[a-zA-Z0-9][a-zA-Z0-9\-]{0,63}\.?)+'
- name: mac
  regex: '(?:[[:xdigit:]]{2}:)(?:[[:xdigit:]]{2}:){4}[[:xdigit:]]{2}'
- name: ssh-key
  regex: 'ssh-rsa AAAA[0-9A-Za-z+/]+={0,3}'
nodes:
- name: interfaces
  subnodes:
  - name: ethernet <query>
    query:
      ls: /sys/class/net
    properties:
    - key: description
      values:
      - template: string
    - key: address
      values:
      - literal: dhcp
      - template: ipv4-cidr
    - key: hardware
      values:
      - template: mac
    - key: mtu
      default:
      - 1500
      values:
      - range:
          lower:
            inclusive: 1
          upper:
            inclusive: 9000
- name: system
  properties:
  - key: hostname
    values:
    - template: hostname
  subnodes:
  - name: dns
    properties:
    - key: domain
      values:
      - template: fqdn
    - key: nameserver
      multiple: true
      default:
      - "1.1.1.1"
      - "1.0.0.1"
      values:
      - template: fqdn
  - name: ntp
    properties:
    - key: server
      multiple: true
      default:
      - "1.pool.ntp.org"
      - "2.pool.ntp.org"
      - "3.pool.ntp.org"
      - "4.pool.ntp.org"
      values:
      - template: fqdn
  - name: users
    subnodes:
    - name: user <query>
      properties:
      - key: password
        values:
        - template: string
      subnodes:
      - name: ssh-keys
        properties:
        - key: key
          multiple: true
          values:
          - template: ssh-key